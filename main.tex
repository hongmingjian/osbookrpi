\documentclass[b5paper,11pt]{book}
\usepackage{subfiles}
\usepackage{ifxetex}
\ifxetex\usepackage{ctex}\else\usepackage{CJKutf8}\fi
\usepackage{graphicx}
\usepackage[newfloat]{minted} %  -shell-escape
\usepackage{ragged2e} % for \justify
\usepackage{caption} % for \captionof
\usepackage{hyperref} % for \htmladdnormallink

\usepackage{titletoc}
\usepackage{titlesec}
\usepackage[b5paper,text={125mm,195mm},centering,left=1in,right=1in,top=1in,bottom=1in]{geometry}
\usepackage[]{geometry}


\newcommand{\onlyinsubfile}[1]{#1}
\newcommand{\notinsubfile}[1]{}
\newenvironment{code}{\captionsetup{type=listing}}{}
\SetupFloatingEnvironment{listing}{name=Code}

\begin{document}
\ifxetex\else\begin{CJK*}{UTF8}{song}\fi
\renewcommand{\onlyinsubfile}[1]{}
\renewcommand{\notinsubfile}[1]{#1}

\title{\Huge 给树莓派写操作系统}
\author{\Huge 洪明坚}
\date{2020年3月}

\maketitle

\subfile{chapter01}
\subfile{chapter02}
\subfile{chapter03}
\subfile{chapter04}

\ifxetex\else\end{CJK*}\fi
\end{document}
